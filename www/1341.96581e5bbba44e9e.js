(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1341],{1341:(he,O,A)=>{"use strict";A.r(O),A.d(O,{AjoutAnnoncePageModule:()=>le});var k=A(4755),j=A(9401),C=A(9972),J=A(116),Z=A(5861),K=A(6730),Y=A.n(K),e=A(2223),H=A(4471),ee=A(7869),$=A(3442);function ne(c,m){if(1&c&&(e.ynx(0),e.TgZ(1,"option",24),e._uU(2),e.qZA(),e.BQk()),2&c){const t=m.$implicit;e.xp6(1),e.s9C("value",t.idMarque),e.xp6(1),e.Oqu(t.marque)}}function U(c,m){if(1&c&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&c){const t=e.oxw().$implicit;e.s9C("value",t.idVoiture),e.xp6(1),e.Oqu(t.nomModele)}}function B(c,m){if(1&c&&(e.ynx(0),e.YNc(1,U,2,2,"option",25),e.BQk()),2&c){const t=m.$implicit,a=e.oxw();e.xp6(1),e.Q6J("ngIf",t.idMarque===a.idMarque)}}function te(c,m){if(1&c&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&c){const t=e.oxw().$implicit;e.s9C("value",t.idCategorie),e.xp6(1),e.Oqu(t.categorie)}}function D(c,m){if(1&c&&(e.ynx(0),e.YNc(1,te,2,2,"option",25),e.BQk()),2&c){const t=m.$implicit,a=e.oxw();e.xp6(1),e.Q6J("ngIf",t.idVoiture===a.idVoiture)}}function re(c,m){if(1&c&&(e.TgZ(0,"option",24),e._uU(1),e.qZA()),2&c){const t=e.oxw().$implicit;e.s9C("value",t.idFicheTechnique),e.xp6(1),e.Oqu(t.idFicheTechnique)}}function S(c,m){if(1&c&&(e.ynx(0),e.YNc(1,re,2,2,"option",25),e.BQk()),2&c){const t=m.$implicit,a=e.oxw();e.xp6(1),e.Q6J("ngIf",t.idVoiture===a.idVoiture)}}function ie(c,m){if(1&c&&(e.TgZ(0,"div",27)(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.qZA(),e.TgZ(9,"p"),e._uU(10),e.qZA(),e.TgZ(11,"p"),e._uU(12),e.qZA(),e.TgZ(13,"p"),e._uU(14),e.qZA(),e.TgZ(15,"p"),e._uU(16),e.qZA(),e.TgZ(17,"p"),e._uU(18),e.qZA(),e.TgZ(19,"p"),e._uU(20),e.qZA(),e.TgZ(21,"p"),e._uU(22),e.qZA()()),2&c){const t=e.oxw().$implicit;e.xp6(2),e.hij("Energie : ",t.energie," "),e.xp6(2),e.hij("Moteur : ",t.moteur,""),e.xp6(2),e.hij("Boite de vitesse : ",t.boite,""),e.xp6(2),e.hij("Litre du moteur : ",t.litreMoteur,""),e.xp6(2),e.hij("Consommation : ",t.consommation,""),e.xp6(2),e.hij("Puissance fiscale : ",t.puissance," CV"),e.xp6(2),e.hij("Nombre de Vitesse : ",t.nbVitesse,""),e.xp6(2),e.hij("Nombre de place : ",t.nbPlace,""),e.xp6(2),e.hij("Nombre de porte : ",t.nbPorte,""),e.xp6(2),e.hij("Longueur : ",t.longueur," m"),e.xp6(2),e.hij("Poids : ",t.poids," Kg")}}function G(c,m){if(1&c&&(e.ynx(0),e.YNc(1,ie,23,11,"div",26),e.BQk()),2&c){const t=m.$implicit,a=e.oxw();e.xp6(1),e.Q6J("ngIf",t.idFicheTechnique===a.ficheChoisi)}}const oe=function(){return["/accueil"]},X=[{path:"",component:(()=>{class c{constructor(t,a,d,g){this.loadingController=t,this.loadingService=a,this.marqueService=d,this.annonceService=g,this.categories=[],this.marques=[],this.voitures=[],this.ficheTechniques=[]}showLoading(){var t=this;return(0,Z.Z)(function*(){yield(yield t.loadingController.create({duration:2500})).present()})()}doRefresh(t){this.loadingService.present(),this.ngOnInit(),t.target.complete(),this.loadingService.dismiss()}onFileSelected(t){this.selectedFile=t.target.files}compressImages(){var t=this;return(0,Z.Z)(function*(){const a=[];for(let d=0;d<t.selectedFile.length;d++){const g=yield t.compressFile(t.selectedFile[d]);a.push(g)}return a})()}compressFile(t){return(0,Z.Z)(function*(){return new Promise((a,d)=>{new(Y())(t,{quality:.8,success(g){const I=new File([g],t.name,{type:"image/jpeg",lastModified:Date.now()});a(I)},error(g){console.error("Erreur de compression :",g),d(g)}})})})()}insertAnnonce(){var t=this;return(0,Z.Z)(function*(){const a=yield t.compressImages(),d=new FormData;for(let g=0;g<a.length;g++)d.append("photos",a[g],a[g].name);d.append("idVoiture",t.idVoiture),d.append("idFicheTechnique",t.ficheChoisi),d.append("idCategorie",t.idCategorie),d.append("kilometrage",t.kilometrage),d.append("etatVoiture",t.etat),d.append("description",t.description),d.append("prixVente",t.prix_vente),console.log(d);try{yield t.annonceService.envoyerFormData(d),console.log("Okey")}catch(g){console.error("Erreur : ",g)}})()}ngOnInit(){var t=this;return(0,Z.Z)(function*(){yield t.showLoading(),t.all_marque(),t.get_all_voiture(),t.all_fiche(),t.all_categori()})()}all_categori(){var t=this;return(0,Z.Z)(function*(){try{t.categories=yield t.annonceService.get_all_categorie(),console.log(t.categories)}catch(a){console.error("Erreur lors de la r\xe9cup\xe9ration des erreur recup categorie",a)}})()}all_fiche(){var t=this;return(0,Z.Z)(function*(){try{t.ficheTechniques=yield t.annonceService.get_all_fiche(),console.log(t.ficheTechniques)}catch(a){console.error("Erreur lors de la r\xe9cup\xe9ration des erreur recup fiche tech",a)}})()}all_marque(){var t=this;return(0,Z.Z)(function*(){try{t.marques=yield t.marqueService.get_all_marque(),console.log(t.marques)}catch(a){console.error("Erreur lors de la r\xe9cup\xe9ration des marques",a)}})()}get_all_voiture(){var t=this;return(0,Z.Z)(function*(){try{t.voitures=yield t.annonceService.get_all_voiture(),console.log(t.voitures)}catch(a){console.error("Erreur lors de la r\xe9cup\xe9ration des voitures by marques",a)}})()}}return c.\u0275fac=function(t){return new(t||c)(e.Y36(C.HT),e.Y36(H.b),e.Y36(ee.w),e.Y36($.Z))},c.\u0275cmp=e.Xpm({type:c,selectors:[["app-ajout-annonce"]],decls:71,vars:16,consts:[[1,"ion-no-border"],["slot","start",1,"menu",3,"routerLink"],["name","chevron-back"],[1,"en-Tete"],[2,"color","black"],["slot","end",1,"menu"],["name","chevron-back",2,"color","white"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[1,"container"],["id","input"],["for","yourUsername",1,"form-label"],[1,"input-group","has-validation"],["name","","id","","name","idMarque",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["name","","id","",1,"form-control",3,"ngModel","ngModelChange"],["id","input",1,"row"],[1,"col-6"],["type","number","name","","id","",1,"form-control",3,"ngModel","ngModelChange"],["type","number","id","",1,"form-control",3,"ngModel","ngModelChange"],["type","texte","name","description","id","",1,"form-control",3,"ngModel","ngModelChange"],["type","number","name","prix_vente","id","",1,"form-control",3,"ngModel","ngModelChange"],["type","file","id","","accept","image/*","multiple","",1,"form-control",2,"font-size","small",3,"change"],["type","submit","value","Valider","id","bouton",1,"btn","btn-primary",3,"click"],[3,"value"],[3,"value",4,"ngIf"],["style","border:0.2px solid rgb(221, 221, 221); color:black;padding: 10px;",4,"ngIf"],[2,"border","0.2px solid rgb(221, 221, 221)","color","black","padding","10px"]],template:function(t,a){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e._UZ(3,"ion-icon",2),e.qZA(),e.TgZ(4,"div",3)(5,"p",4),e._uU(6,"Insertion annonce"),e.qZA()(),e.TgZ(7,"ion-buttons",5),e._UZ(8,"ion-icon",6),e.qZA()()(),e.TgZ(9,"ion-content",7)(10,"ion-refresher",8),e.NdJ("ionRefresh",function(g){return a.doRefresh(g)}),e._UZ(11,"ion-refresher-content"),e.qZA(),e.TgZ(12,"div",9)(13,"div")(14,"div",10)(15,"label",11),e._uU(16,"Marque"),e.qZA(),e.TgZ(17,"div",12)(18,"select",13),e.NdJ("ngModelChange",function(g){return a.idMarque=g}),e.YNc(19,ne,3,2,"ng-container",14),e.qZA()()(),e.TgZ(20,"div",10)(21,"label",11),e._uU(22,"Voiture"),e.qZA(),e.TgZ(23,"div",12)(24,"select",15),e.NdJ("ngModelChange",function(g){return a.idVoiture=g}),e.YNc(25,B,2,1,"ng-container",14),e.qZA()()(),e.TgZ(26,"div",10)(27,"label",11),e._uU(28,"Categorie"),e.qZA(),e.TgZ(29,"div",12)(30,"select",15),e.NdJ("ngModelChange",function(g){return a.idCategorie=g}),e.YNc(31,D,2,1,"ng-container",14),e.qZA()()(),e.TgZ(32,"div",10)(33,"label",11),e._uU(34,"Fiche technique"),e.qZA(),e.TgZ(35,"div",12)(36,"select",15),e.NdJ("ngModelChange",function(g){return a.ficheChoisi=g}),e.YNc(37,S,2,1,"ng-container",14),e.qZA()()(),e._UZ(38,"br"),e.YNc(39,G,2,1,"ng-container",14),e.TgZ(40,"div",16)(41,"div",17)(42,"div")(43,"label",11),e._uU(44,"Kilom\xe9trage"),e.qZA(),e.TgZ(45,"div",12)(46,"input",18),e.NdJ("ngModelChange",function(g){return a.kilometrage=g}),e.qZA()()()(),e.TgZ(47,"div",17)(48,"div")(49,"label",11),e._uU(50,"Etat sur 10"),e.qZA(),e.TgZ(51,"div",12)(52,"input",19),e.NdJ("ngModelChange",function(g){return a.etat=g}),e.qZA()()()()(),e.TgZ(53,"div",10)(54,"label",11),e._uU(55,"Description"),e.qZA(),e.TgZ(56,"div",12)(57,"textarea",20),e.NdJ("ngModelChange",function(g){return a.description=g}),e.qZA()()(),e.TgZ(58,"div",10)(59,"label",11),e._uU(60,"Prix de vente"),e.qZA(),e.TgZ(61,"div",12)(62,"input",21),e.NdJ("ngModelChange",function(g){return a.prix_vente=g}),e.qZA()()(),e.TgZ(63,"div",10)(64,"label",11),e._uU(65,"Photo"),e.qZA(),e.TgZ(66,"div",12)(67,"input",22),e.NdJ("change",function(g){return a.onFileSelected(g)}),e.qZA()()(),e._UZ(68,"br"),e.TgZ(69,"input",23),e.NdJ("click",function(){return a.insertAnnonce()}),e.qZA()(),e._UZ(70,"br"),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("routerLink",e.DdM(15,oe)),e.xp6(7),e.Q6J("fullscreen",!0),e.xp6(9),e.Q6J("ngModel",a.idMarque),e.xp6(1),e.Q6J("ngForOf",a.marques),e.xp6(5),e.Q6J("ngModel",a.idVoiture),e.xp6(1),e.Q6J("ngForOf",a.voitures),e.xp6(5),e.Q6J("ngModel",a.idCategorie),e.xp6(1),e.Q6J("ngForOf",a.categories),e.xp6(5),e.Q6J("ngModel",a.ficheChoisi),e.xp6(1),e.Q6J("ngForOf",a.ficheTechniques),e.xp6(2),e.Q6J("ngForOf",a.ficheTechniques),e.xp6(7),e.Q6J("ngModel",a.kilometrage),e.xp6(6),e.Q6J("ngModel",a.etat),e.xp6(5),e.Q6J("ngModel",a.description),e.xp6(5),e.Q6J("ngModel",a.prix_vente))},dependencies:[k.sg,k.O5,j.YN,j.Kr,j.Fj,j.wV,j.EJ,j.JJ,j.On,C.Sm,C.W2,C.Gu,C.gu,C.nJ,C.Wo,C.sr,C.YI,J.rH],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: none;background-color:#fff;border:none}.en-Tete[_ngcontent-%COMP%]{width:100%;text-align:center;background-color:#fff;margin-top:14px}.menu[_ngcontent-%COMP%]{width:37px;justify-content:center;color:#1a1313}.menu[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:x-large;color:#1a1313}ion-menu-button[_ngcontent-%COMP%]{font-size:xx-large;color:#1e2059}ion-content[_ngcontent-%COMP%]{--background:none;background-color:#fff;position:relative}#bouton[_ngcontent-%COMP%]{background-color:#000;color:#fff;border:none;font-size:smaller;width:110px}#input[_ngcontent-%COMP%]{margin-top:10px}#input[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:100;font-size:smaller;opacity:.79;color:#000}"]}),c})()}];let ae=(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({imports:[J.Bz.forChild(X),J.Bz]}),c})(),le=(()=>{class c{}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({imports:[k.ez,j.u5,C.Pc,ae]}),c})()},6730:function(he){he.exports=function(){"use strict";function O(o,n){var r=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);n&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(o,l).enumerable})),r.push.apply(r,i)}return r}function A(o){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?O(Object(r),!0).forEach(function(i){J(o,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(r,i))})}return o}function j(o,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,Y(i.key),i)}}function J(o,n,r){return(n=Y(n))in o?Object.defineProperty(o,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):o[n]=r,o}function Z(){return Z=Object.assign?Object.assign.bind():function(o){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(o[i]=r[i])}return o},Z.apply(this,arguments)}function Y(o){var n=function K(o,n){if("object"!=typeof o||null===o)return o;var r=o[Symbol.toPrimitive];if(void 0!==r){var i=r.call(o,n||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(o)}(o,"string");return"symbol"==typeof n?n:String(n)}var o,n,r,i,l,s,v,p,e={exports:{}};o=e,typeof window>"u"||(n=window,r=n.HTMLCanvasElement&&n.HTMLCanvasElement.prototype,i=n.Blob&&function(){try{return!!new Blob}catch{return!1}}(),l=i&&n.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch{return!1}}(),s=n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,v=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,p=(i||s)&&n.atob&&n.ArrayBuffer&&n.Uint8Array&&function(f){var h,b,y,M,_,u,P,x,F;if(!(h=f.match(v)))throw new Error("invalid data URI");for(b=h[2]?h[1]:"text/plain"+(h[3]||";charset=US-ASCII"),y=!!h[4],M=f.slice(h[0].length),_=y?atob(M):decodeURIComponent(M),u=new ArrayBuffer(_.length),P=new Uint8Array(u),x=0;x<_.length;x+=1)P[x]=_.charCodeAt(x);return i?new Blob([l?P:u],{type:b}):((F=new s).append(u),F.getBlob(b))},n.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(f,h,b){var y=this;setTimeout(function(){f(b&&r.toDataURL&&p?p(y.toDataURL(h,b)):y.mozGetAsFile("blob",h))})}:r.toDataURL&&p&&(r.toBlob=r.msToBlob?function(f,h,b){var y=this;setTimeout(function(){f((h&&"image/png"!==h||b)&&r.toDataURL&&p?p(y.toDataURL(h,b)):y.msToBlob(h))})}:function(f,h,b){var y=this;setTimeout(function(){f(p(y.toDataURL(h,b)))})})),o.exports?o.exports=p:n.dataURLtoBlob=p);var H=e.exports,$={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},U=typeof window<"u"&&typeof window.document<"u"?window:{},B=function(n){return n>0&&n<1/0},te=Array.prototype.slice;function D(o){return Array.from?Array.from(o):te.call(o)}var re=/^image\/.+$/;function S(o){return re.test(o)}var G=String.fromCharCode;var de=U.btoa;function X(o,n){for(var r=[],l=new Uint8Array(o);l.length>0;)r.push(G.apply(null,D(l.subarray(0,8192)))),l=l.subarray(8192);return"data:".concat(n,";base64,").concat(de(r.join("")))}function ae(o){var r,n=new DataView(o);try{var i,l,s;if(255===n.getUint8(0)&&216===n.getUint8(1))for(var v=n.byteLength,p=2;p+1<v;){if(255===n.getUint8(p)&&225===n.getUint8(p+1)){l=p;break}p+=1}if(l){var h=l+10;if("Exif"===function oe(o,n,r){var l,i="";for(r+=n,l=n;l<r;l+=1)i+=G(o.getUint8(l));return i}(n,l+4,4)){var b=n.getUint16(h);if(((i=18761===b)||19789===b)&&42===n.getUint16(h+2,i)){var y=n.getUint32(h+4,i);y>=8&&(s=h+y)}}}if(s){var _,u,M=n.getUint16(s,i);for(u=0;u<M;u+=1)if(274===n.getUint16(_=s+12*u+2,i)){r=n.getUint16(_+=8,i),n.setUint16(_,1,i);break}}}catch{r=1}return r}var c=/\.\d*(?:0|9){12}\d*$/;function m(o){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return c.test(o)?Math.round(o*n)/n:o}function t(o){var n=o.aspectRatio,r=o.height,i=o.width,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none",s=B(i),v=B(r);if(s&&v){var p=r*n;("contain"===l||"none"===l)&&p>i||"cover"===l&&p<i?r=i/n:i=r*n}else s?r=i/n:v&&(i=r*n);return{width:i,height:r}}var g=U.ArrayBuffer,I=U.FileReader,q=U.URL||U.webkitURL,Be=/\.\w+$/,Fe=U.Compressor,Ee=function(){function o(n,r){(function k(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")})(this,o),this.file=n,this.exif=[],this.image=new Image,this.options=A(A({},$),r),this.aborted=!1,this.result=null,this.init()}return function C(o,n,r){return n&&j(o.prototype,n),r&&j(o,r),Object.defineProperty(o,"prototype",{writable:!1}),o}(o,[{key:"init",value:function(){var r=this,i=this.file,l=this.options;if(function(n){return!(typeof Blob>"u")&&(n instanceof Blob||"[object Blob]"===Object.prototype.toString.call(n))}(i)){var s=i.type;if(S(s))if(q&&I){g||(l.checkOrientation=!1,l.retainExif=!1);var v="image/jpeg"===s,p=v&&l.checkOrientation,f=v&&l.retainExif;if(!q||p||f){var h=new I;this.reader=h,h.onload=function(b){var M=b.target.result,_={},u=1;p&&(u=ae(M))>1&&Z(_,function le(o){var n=0,r=1,i=1;switch(o){case 2:r=-1;break;case 3:n=-180;break;case 4:i=-1;break;case 5:n=90,i=-1;break;case 6:n=90;break;case 7:n=90,r=-1;break;case 8:n=-90}return{rotate:n,scaleX:r,scaleY:i}}(u)),f&&(r.exif=function a(o){for(var n=D(new Uint8Array(o)),r=n.length,i=[],l=0;l+3<r;){var s=n[l],v=n[l+1];if(255===s&&218===v)break;if(255===s&&216===v)l+=2;else{var f=l+(256*n[l+2]+n[l+3])+2,h=n.slice(l,f);i.push(h),l=f}}return i.reduce(function(b,y){return 255===y[0]&&225===y[1]?b.concat(y):b},[])}(M)),_.url=p||f?!q||u>1?X(M,s):q.createObjectURL(i):M,r.load(_)},h.onabort=function(){r.fail(new Error("Aborted to read the image with FileReader."))},h.onerror=function(){r.fail(new Error("Failed to read the image with FileReader."))},h.onloadend=function(){r.reader=null},p||f?h.readAsArrayBuffer(i):h.readAsDataURL(i)}else this.load({url:q.createObjectURL(i)})}else this.fail(new Error("The current browser does not support image compression."));else this.fail(new Error("The first argument must be an image File or Blob object."))}else this.fail(new Error("The first argument must be a File or Blob object."))}},{key:"load",value:function(r){var i=this,l=this.file,s=this.image;s.onload=function(){i.draw(A(A({},r),{},{naturalWidth:s.naturalWidth,naturalHeight:s.naturalHeight}))},s.onabort=function(){i.fail(new Error("Aborted to load the image."))},s.onerror=function(){i.fail(new Error("Failed to load the image."))},U.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(U.navigator.userAgent)&&(s.crossOrigin="anonymous"),s.alt=l.name,s.src=r.url}},{key:"draw",value:function(r){var i=this,l=r.naturalWidth,s=r.naturalHeight,v=r.rotate,p=void 0===v?0:v,f=r.scaleX,h=void 0===f?1:f,b=r.scaleY,y=void 0===b?1:b,M=this.file,_=this.image,u=this.options,P=document.createElement("canvas"),x=P.getContext("2d"),F=Math.abs(p)%180==90,ce=("contain"===u.resize||"cover"===u.resize)&&B(u.width)&&B(u.height),N=Math.max(u.maxWidth,0)||1/0,L=Math.max(u.maxHeight,0)||1/0,Q=Math.max(u.minWidth,0)||0,z=Math.max(u.minHeight,0)||0,E=l/s,T=u.width,w=u.height;if(F){var pe=[L,N];N=pe[0],L=pe[1];var me=[z,Q];Q=me[0],z=me[1];var ve=[w,T];T=ve[0],w=ve[1]}ce&&(E=T/w);var be=t({aspectRatio:E,width:N,height:L},"contain");N=be.width,L=be.height;var ye=t({aspectRatio:E,width:Q,height:z},"cover");if(Q=ye.width,z=ye.height,ce){var Ae=t({aspectRatio:E,width:T,height:w},u.resize);T=Ae.width,w=Ae.height}else{var _e=t({aspectRatio:E,width:T,height:w}),xe=_e.width;T=void 0===xe?l:xe;var Te=_e.height;w=void 0===Te?s:Te}var Re=-(T=Math.floor(m(Math.min(Math.max(T,Q),N))))/2,ke=-(w=Math.floor(m(Math.min(Math.max(w,z),L))))/2,Je=T,De=w,se=[];if(ce){var ue,ge,Me=t({aspectRatio:E,width:l,height:s},{contain:"cover",cover:"contain"}[u.resize]);se.push((l-(ue=Me.width))/2,(s-(ge=Me.height))/2,ue,ge)}if(se.push(Re,ke,Je,De),F){var Pe=[w,T];T=Pe[0],w=Pe[1]}P.width=T,P.height=w,S(u.mimeType)||(u.mimeType=M.type);var Ce="transparent";M.size>u.convertSize&&u.convertTypes.indexOf(u.mimeType)>=0&&(u.mimeType="image/jpeg");var je="image/jpeg"===u.mimeType;if(je&&(Ce="#fff"),x.fillStyle=Ce,x.fillRect(0,0,T,w),u.beforeDraw&&u.beforeDraw.call(this,x,P),!this.aborted&&(x.save(),x.translate(T/2,w/2),x.rotate(p*Math.PI/180),x.scale(h,y),x.drawImage.apply(x,[_].concat(se)),x.restore(),u.drew&&u.drew.call(this,x,P),!this.aborted)){var Ue=function(V){if(!i.aborted){var qe=function(W){return i.done({naturalWidth:l,naturalHeight:s,result:W})};if(V&&je&&u.retainExif&&i.exif&&i.exif.length>0){var Oe=function(W){return qe(H(X(function d(o,n){var r=D(new Uint8Array(o));if(255!==r[2]||224!==r[3])return o;var l=[255,216].concat(n,r.slice(4+(256*r[4]+r[5])));return new Uint8Array(l)}(W,i.exif),u.mimeType)))};if(V.arrayBuffer)V.arrayBuffer().then(Oe).catch(function(){i.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var R=new I;i.reader=R,R.onload=function(fe){Oe(fe.target.result)},R.onabort=function(){i.fail(new Error("Aborted to read the compressed image with FileReader."))},R.onerror=function(){i.fail(new Error("Failed to read the compressed image with FileReader."))},R.onloadend=function(){i.reader=null},R.readAsArrayBuffer(V)}}else qe(V)}};P.toBlob?P.toBlob(Ue,u.mimeType,u.quality):Ue(H(P.toDataURL(u.mimeType,u.quality)))}}},{key:"done",value:function(r){var i=r.naturalWidth,l=r.naturalHeight,s=r.result,v=this.file,p=this.image,f=this.options;if(q&&0===p.src.indexOf("blob:")&&q.revokeObjectURL(p.src),s)if(f.strict&&!f.retainExif&&s.size>v.size&&f.mimeType===v.type&&!(f.width>i||f.height>l||f.minWidth>i||f.minHeight>l||f.maxWidth<i||f.maxHeight<l))s=v;else{var h=new Date;s.lastModified=h.getTime(),s.lastModifiedDate=h,s.name=v.name,s.name&&s.type!==v.type&&(s.name=s.name.replace(Be,function ie(o){var n=S(o)?o.substr(6):"";return"jpeg"===n&&(n="jpg"),".".concat(n)}(s.type)))}else s=v;this.result=s,f.success&&f.success.call(this,s)}},{key:"fail",value:function(r){var i=this.options;if(!i.error)throw r;i.error.call(this,r)}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Fe,o}},{key:"setDefaults",value:function(r){Z($,r)}}]),o}();return Ee}()}}]);